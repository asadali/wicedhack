<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <link rel="stylesheet" type="text/css" href="../../styles/buttons.css" />
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <title>Broadcom Facebook Controlled Application</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="../../scripts/general_ajax_script.js" type="text/javascript"></script>
    <script type="text/javascript">
    /* <![CDATA[ */
    function custom_ajax( ajax_url, elem_id, start_text, disp_progress, inprog_text, endfunc, failtext, failfunc )
{
  req = null;
  if (elem_id && start_text) document.getElementById(elem_id).innerHTML = start_text;
  if (window.XMLHttpRequest)
  {
    req = new XMLHttpRequest();
    if (req.overrideMimeType)
    {
      req.overrideMimeType('text/xml');
    }
  }
  else if (window.ActiveXObject)
  {
    try {
      req = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (e)
    {
      try {
          req = new ActiveXObject("Microsoft.XMLHTTP");
      } catch (e) {
        alert("Your browser does not support AJAX - please use a different browser.");
        return;
      }
    }
  }
  try {
    req.onprogress = function( e )
    {
        if (elem_id && disp_progress) document.getElementById(elem_id).innerHTML = req.responseText;
    }
  } catch (e) { if (elem_id && inprog_text) document.getElementById(elem_id).innerHTML = inprog_text; }
  req.onreadystatechange = function()
  {
    if(req.readyState == 4)
    {
      if(req.status == 200)
      {
        var jsonObj = JSON.parse(req.responseText);
        var bodyText = "Nothing to Display";
        var resText = undefined;
        for (var i = 0; i <= jsonObj["data"].length - 1; i++) {
          if(jsonObj["data"][i]["message"] != undefined){
            if (resText == undefined)
              resText = "<li class=\"list-group-item\">"+jsonObj["data"][i]["message"] + "</li>";
            else
            resText = resText + "<li class=\"list-group-item\">"+jsonObj["data"][i]["message"] + "</li>";
            console.log("[JSON]", jsonObj["data"][i]["message"]);
          }
        };
        // if (resText == undefined)
        //  insert_and_eval(elem_id, bodyText);
        // else <p></p>
         insert_and_eval(elem_id, resText);
        //if (elem_id) insert_and_eval( elem_id, req.responseText );
        if (endfunc) endfunc(req, elem_id);
      }
      else
      {
        if (elem_id && failtext) document.getElementById(elem_id).innerHTML = failtext + " : " + req.statusText;
        if (failfunc) failfunc(req, elem_id);
      }
    }
  };
  req.open("GET", ajax_url, true);
  req.send(null);
}


       function reloadData()
       {
         /*do_ajax('/fb_report.html','currentData',null,0,null,null,'<p>There was a problem retrieving data</p>',null);
         timeoutID = setTimeout('reloadData()', 1000);*/
       }
       function loadfbdata()
       {
        custom_ajax('https://graph.facebook.com/wiced123/posts?access_token=CAAKbXnsGZA3gBAEvY7bLKcYHoci5fQtNZBkh2mxWGX7jHa2wWwOMjyGQobS9VIZBMCgzV3yIHykZCeEdSAF4KZAv1MDN1e9x68itWKbnm602lb5N07gsICvaI6arSZAotNIB7wpvsZBPPIWW9ro7m4IyaUUM4ZBcoeZCpUbsFOZCuwXvOc4unUbcvoSsAQ6mHKTfThYAkZCHZAzfn8ZBoJRMt1utHr28vaql07nAZD',
         'currentData', null, 0, null, null, '<p>FB data error</p>, null');
        timeoutID = setTimeout('reloadData()', 1000);

       }
    /* ]]> */
    </script>
  </head>
  <body onload="reloadData()" style="font-family:verdana;">
    <div class="container">
    <table class="table" border='0' cellpadding='0' cellspacing='0' width="98%">
      <tr style="height:20px"><td>&nbsp;</td></tr>
      <tr style="border-collapse: collapse; padding: 0;">
        <td style="width:20px"></td>
        <td style="width:117px"><img src="../../images/brcmlogo.png" alt="Broadcom Logo" /></td>
        <td style="width:20px;background-image:url('../../images/brcmlogo_line.png');"></td>
        <td style="vertical-align:middle; text-align:center; font: bold 25px/100% Verdana, Arial, Helvetica, sans-serif;background-image:url('../../images/brcmlogo_line.png');">
        WICED&trade; Facebook Controlled Application
        </td>
        <td style="width:137px;background-image:url('../../images/brcmlogo_line.png');"></td>
      </tr>
      <tr><td>&nbsp;</td></tr>
    </table>
    <div id="currentData" >Retrieving current sensor data...
    </div>
    <button type="button"  class="btn btn-default" onclick="loadfbdata()">LoadFBData</button>
    <div class = "well well-lg" style="margin-left:20px" id="main_text" >
      <p>Click a button, then look at the UART ... </p>
      <form name="input" action="/button_handler" method="get"> <table> <tr>
        <td><input class="btn btn-default" type="submit" name=btname value="Button-01" /></td>
        <td><input class="btn btn-default" type="submit" name=btname value="Button-02" /></td>
        <td><input class="btn btn-default" type="submit" name=btname value="Button-03" /></td>
        <td><input class="btn btn-default" type="submit" name=btname value="Button-04" /></td>
      </tr>
    </form>
  </div>
</div>
  </body>
</html>